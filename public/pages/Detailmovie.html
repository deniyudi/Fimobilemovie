<style>
    .demo-card-header-pic .card-header {
  height: 100vw;
  background-size: contain;
  background-position: center;
  color: #fff;
}
.demo-card-header-pic .card-content-padding .date{
  color: #8e8e93;
}
</style>

<template>
    <div class="page light">
        <div class="navbar">
            <div class="navbar-inner">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="material-icons">navigate_before</i>
                    </a>
                </div>
                <div class="title"><img src="img/logo-header.png" alt="" class="header-logo"> </div>
                <div class="right">
                    <a class="link icon-only searchbar-enable" data-searchbar=".searchbar-com-de">
                        <i class="icon material-icons">search</i>
                    </a>
                </div>
    
                <form data-search-container=".components-list" data-search-in="a" class="searchbar searchbar-expandable searchbar-com-de searchbar-init">
                    <div class="searchbar-inner">
                        <div class="searchbar-input-wrap">
                            <input type="search" placeholder="Search components">
                            <i class="searchbar-icon"></i>
                            <span class="input-clear-button"></span>
                        </div>
                        <span class="searchbar-disable-button if-not-aurora"></span>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="page-content">
            <div class="block">
                <div class="card demo-card-header-pic">
                    <div style="background-image:url(https://image.tmdb.org/t/p/w220_and_h330_face/wHa6KOJAoNTFLFtp7wguUJKSnju.jpg);" class="card-header align-items-flex-end" style="background-size: cover;"></div>
                    <!-- <div class="card-content card-content-padding">
                      <div class="subtitle">
                      </div>
                    </div> -->
                    <div class="card-footer">
                        <span>
                            <div class="text-align-right">
                                <div class="row">
                                    <div class="avatar avatar-50 no-shadow border-0">    
                                        <i class="material-icons text-template ">star_lefthalf_fill</i>
                                    </div>
                                    <div class="col align-self-center pl-0">4.2</div>
                                </div>
                            </div>
                        </span>
                        <span>
                            <div class="text-align-right">
                                <div class="row">
                                    <div class="avatar avatar-50 no-shadow border-0">    
                                        <i class="material-icons text-template ">visibility</i>
                                    </div>
                                <div class="col align-self-center pl-0"></div> 
                                </div>
                            </div>
                        </span>
                        <span>
                            <div class="text-align-right">
                                <div class="row">
                                    <div class="avatar avatar-50 no-shadow border-0">    
                                        <i class="material-icons text-template ">watch_later
                                        </i>
                                    </div>
                                <div class="col align-self-center pl-0">67 min</div>
                                </div>
                            </div>
                        </span>
                    </div>
                    <div class="card-footer h-120">
                        <div class="col">
                            <h3 style="font-weight: bold; color: black;">The Flash</h3>
                            <p>After a particle accelerator causes a freak storm, CSI Investigator Barry Allen is struck by lightning and falls into a coma. Months later he awakens with the power of super speed, granting him the ability to move through Central City like an unseen guardian angel. Though initially excited by his newfound powers, Barry is shocked to discover he is not the only "meta-human" who was created in the wake of the accelerator explosion -- and not everyone is using their new powers for good. Barry partners with S.T.A.R. Labs and dedicates his life to protect the innocent.</p>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="col">
                            <tr>
                                <td>Release</td>
                                <td>:</td>
                                <td>12 August 2010</td>
                            </tr>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span>
                            <div class="col">
                                <b>
                                    <p>Saputra</p>
                                </b>
                                <p>Kreator</p>
                            </div>
                        </span>
                        <span>
                            <div class="col">
                                <b>
                                    <p>Greg Nowkolow</p>
                                </b>
                                <p>Kreator</p>
                            </div>
                        </span>
                        <span>
                            <div class="col">
                                <b>
                                    <p>Berlanti</p>
                                </b>
                                <p>Kreator</p>
                            </div>
                        </span>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><h3>Actors:</h3></div>
                    <div class="card-content">
                      <div class="list media-list">
                        <ul>
                          <li class="item-content">
                            <div class="item-media"><img src="https://image.tmdb.org/t/p/w66_and_h66_face/5qHNjhtjMD4YWH3UP0rm4tKwxCL.jpg" width="80" style="border-radius: 10%;"/></div>
                            <div class="item-inner">
                              <div class="item-title-row">
                                <div class="item-title">Rowbert Downey Jr</div>
                              </div>
                              <div class="item-subtitle">Tony Stark/Iron Man</div>
                            </div>
                          </li>
                          <li class="item-content">
                            <div class="item-media"><img src="https://image.tmdb.org/t/p/w120_and_h133_face/kN7sPp4ObBcGHsgNQNwawNpuIky.jpg" width="80" style="border-radius: 10%;"/></div>
                            <div class="item-inner">
                              <div class="item-title-row">
                                <div class="item-title">Chris Hemsworth</div>
                              </div>
                              <div class="item-subtitle">Thor Odinson</div>
                            </div>
                          </li>
                          <li class="item-content">
                            <div class="item-media"><img src="https://image.tmdb.org/t/p/w66_and_h66_face/6NsMbJXRlDZuDzatN2akFdGuTvx.jpg" width="80" style="border-radius: 10%;"/></div>
                            <div class="item-inner">
                              <div class="item-title-row">
                                <div class="item-title">Scarlett Johansson</div>
                              </div>
                              <div class="item-subtitle">Black Widow</div>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                    <div class="card-footer"></div>
                  </div>
            </div>
        </div>
    </div>
    
</template>

<script>
    const API_URL = 'https://api.themoviedb.org/3/';
    const API_KEY = '7e97f4650ad722d5b44df91dee514674';
    const MOVIE_ENDPOINT = id => `${API_URL}movie/${id}?api_key=${API_KEY}`;
    const CREDITS_ENDPOINT = id => `${API_URL}movie/${id}/credits?api_key=${API_KEY}`;

    return {
        
        data: function(){

        // setTimeout(function(){
        //     console.log(window.localStorage.getItem('id'));
        // },900)
      
            
            var isLoading;
            var error;
            var movie;

            var idmov = window.localStorage.getItem('id');
                try{
                    isLoading = true;
                    error = false;
                    movie = fetchMovie(idmov);
                    console.log(movie);
                }catch(err){
                    error = true;
                }
                isLoading = false;

             async function fetchMovie (movieId) {
                const endpoint = MOVIE_ENDPOINT(movieId);
                const creditsEndpoint = CREDITS_ENDPOINT(movieId);

                const result = await (await fetch(endpoint)).json();
                const creditsResult = await (await fetch(creditsEndpoint)).json();

                const directors = creditsResult.crew.filter(
                    member => member.job === 'Director'
                );

                return {
                    ...result,
                    actors: creditsResult.cast,
                    directors
                }
        }
    }
    }
</script>